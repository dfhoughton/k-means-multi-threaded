// the stuff to do on a worker thread